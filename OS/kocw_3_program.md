# 프로그램의 구조와 실행

## 프로그램의 구조와 인터럽트

- 프로그램의 주소 영역
    1. Code 영역
        - 기계어 명령으로 변환된 우리가 작성한 프로그램 함수들의 코드 저장
    2. Data 영역
        - 전역 변수 등 프로그램이 사용하는 데이터/자료구조 저장
    3. Stack 영역
        - 호출된 함수의 수행을 마치고 복귀할 주소 및 데이터를 임시로 저장
        - 함수가 호출되면, 다음에 실행할 명령(instruction)이 메모리 위치가 바뀜 → 복귀주소 사용

## 프로그램 실행

1. 디스크에 존재하던 실행파일이 메모리에 적재
    - 일부분만 메모리에 올리고 나머지는 디스트의 특정 영역에 내려가 있음
2. CPU를 할당받고 명령을 수행하고 있는 상태

- 가상 메모리
    
    <img width="700" alt="os_2_3" src="https://user-images.githubusercontent.com/55101567/232428909-a3ac326a-47ff-4e69-be6a-d5e7a71341de.png">
    
    - 각각 프로그램마다 독자적으로 존재하는 프로그램의 주소 공간인 `**가상메모리**`를 가짐
        - 가상메모리는 실제 물리적 메모리의 주소와 독립적으로 각 프로그램마다 독자적인 주소 공간을 가짐
    - 커널의 주소 공간
        
        <img width="450" alt="os_2_3" src="https://user-images.githubusercontent.com/55101567/232428902-fc5a0ea5-5f5e-4453-aa3e-820096700c3f.png">
        
        1. Code 영역
            - 자원을 관리하기 위한 부분, 시스템 콜 코드 등
        2. Data 영역
            - PCB 등 각종 자원을 관리하기 위한 자료구조
            - 각 프로세스마다 PCB가 따로 있음(프로그램의 복귀 주소 저장)
        3. Stack 영역
            - 커널 내 함수호출 시, 복귀 주소 저장
            - 커널 Stack은 현재 수행 중인 프로세스마다 별도의 Stack을 두어 관리

## 사용자 프로그램이 사용하는 함수

1. 사용자 정의함수
    - 프로그래머가 직접 작성한 함수
2. 라이브러리 함수
    - 이미 누군가 작성해놓은 함수를 호출만 해서 사용
3. 커널 함수
    - 운영체제 커널의 코드에 정의된 함수
    1. 시스템 콜 함수
    2. 인터럽트 처리 함수

## 프로세스의 두 가지 실행 상태

<img width="450" alt="os_2_3" src="https://user-images.githubusercontent.com/55101567/232428912-294d4fae-d87a-40c5-824c-a830d807a30f.png">

- 하나의 프로세스가 수행을 완료하기까지 프로세스 자신의 주소 공간뿐만 아니라 커널의 주소 공간의 코드도 실행
1. 사용자 모드에서의 실행 상태
2. 커널 모드에서의 실행 상태 
    
    → 커널이 실행 상태가 아닌 똑같이 해당 프로세스가 실행 상태에 있음


### 레퍼런스

---

- 반효경, 운영체제, KOCW, [http://www.kocw.net/home/search/kemView.do?kemId=1046323](http://www.kocw.net/home/search/kemView.do?kemId=1046323)
- 반효경, 운영체제와 정보기술의 원리